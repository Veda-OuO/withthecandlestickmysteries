<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>With the Candlestick Mysteries</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body, html {
      height: 100%;
      font-family: Georgia, sans-serif;
      position: relative;
    }
    
    body::before {
      content: "";
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: url('assets/lawrence.jpg');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      background-attachment: fixed;
      min-height: 100vh;
      height: 100%;
      z-index: -1;
    }

    .banner {
      width: 100%;
      background-color: #222;
      color: white;
      padding: 10px 20px;
      position: fixed;
      top: 0;
      left: 0;
      z-index: 1000;
      text-align: center;
      font-size: 18px;
      height: 50px;
    }
    
    .container {
      display: flex;
      min-height: 100vh;
      padding-top: 50px;
    }
    
    .sidebar {
      width: 280px;
      background-color: #111;
      color: white;
      padding: 10px;
      overflow-y: auto;
      position: fixed;
      top: 50px;
      left: 0;
      bottom: 0;
      z-index: 999;
    }
    
    .counter {
      font-size: 20px;
      color: rgb(255, 255, 255);
      margin-bottom: 20px;
      text-underline-offset: 2px;
      background-color: #8B0000;
      padding: 15px;
      border-radius: 8px;
      text-align: center;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);
      border: 2px solid #c7c7c7;
    }
    
    .link-list a {
      display: block;
      padding: 10px;
      color: white;
      text-decoration: none;
      border-bottom: 1px solid #444;
      white-space: nowrap;
    }
    
    .link-list a:hover {
      background-color: #333;
    }
    
    .category {
      padding: 10px;
      background-color: #e9b60ece;
      color: #000000;
      font-weight: bold;
      border-bottom: 3px solid #d1a000;
      margin-top: 10px;
      text-shadow: 0 0 3px rgb(85, 85, 85);
    }
    
    .main {
      margin-left: 280px;
      flex-grow: 1;
      padding: 20px;
      position: relative;
      min-height: calc(100vh - 50px);
    }
    
    .title {
      font-size: 100px;
      color: rgb(255, 166, 0);
      text-shadow: 0 0 10px rgb(0, 0, 0);
      padding: 10px;
      margin-bottom: 20px;
    }
    
    .body-text {
      font-size: 23px;
      color: white;
      text-shadow: 0 0 5px black;
    }
    
    .text-box {
      background-color: rgba(209, 209, 209, 0.925);
      color: rgb(0, 0, 0);
      padding: 20px;
      overflow-y: auto;
      border-radius: 10px;
      box-shadow: 0 0 15px rgba(0,0,0,0.6);
      max-height: calc(100vh - 250px);
    }

    .bottom-image {
      margin-top: 20px;
      text-align: center;
    }

    .bottom-image img {
      max-width: 100%;
      height: auto;
      border-radius: 10px;
      box-shadow: 0 0 15px rgba(0,0,0,0.6);
    }

    .link-list a.visited {
      background-color: #888888;
      color: #000000;
      text-decoration: solid;
    }

    .link-list a.special {
      background-color: #002382;
      color: #ffffff;
      font-weight: bold;
      text-shadow: 0 0 3px black;
    }

    .link-list a.special1 {
      background-color: #09008a;
      color: #ffffff;
      font-weight: bold;
      text-shadow: 0 0 3px black;
    }

    /* Mobile menu toggle button */
    .menu-toggle {
      display: none;
      position: fixed;
      top: 60px;
      left: 10px;
      z-index: 1001;
      background-color: #333;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 5px;
      cursor: pointer;
    }

    /* Mobile styles */
    @media (max-width: 768px) {
      .menu-toggle {
        display: block;
      }
      
      .sidebar {
        width: 250px;
        transform: translateX(-100%);
        transition: transform 0.3s ease;
        z-index: 1002;
      }
      
      .sidebar.open {
        transform: translateX(0);
      }
      
      .main {
        margin-left: 0;
        padding: 10px;
      }
      
      .title {
        font-size: 40px;
        margin-top: 50px;
      }
      
      .text-box {
        max-height: none;
        margin-top: 10px;
        padding: 15px;
        font-size: 16px;
      }
      
      .banner {
        font-size: 16px;
      }
    }
    
    /* Small mobile styles */
    @media (max-width: 480px) {
      .title {
        font-size: 30px;
      }
      
      .text-box {
        font-size: 14px;
        padding: 10px;
      }
      
      .sidebar {
        width: 200px;
      }
    }
  </style>
</head>
<body>
  <div class="banner">Case 1: Where's Wesley</div>
  <button class="menu-toggle" id="menuToggle">â˜° Menu</button>
  
  <div class="container">
    <div class="sidebar" id="sidebar">
      <div class="counter">Investigative Hours: <span id="counter">0</span></div>
      <div class="link-list" id="linkList"></div>
    </div>
    
    <div class="main" id="main">
      <div class="title" id="title">Mrs. Lawrence</div>
      <div class="text-box">
<p><span style="font-weight: 400;">Mrs. Lawrence had just finished stowing the last of the evening&rsquo;s dishes when I approached her in the kitchen. She was a woman whose 60-some years had treated her harshly. Her grey hair was pulled into a taught bun, exposing loose skin on her neck and jaw.&nbsp;</span></p>
<p>&nbsp;</p>
<p><span style="font-weight: 400;">I knocked softly on the threshold so as not to startle her. </span><span style="font-weight: 400;"><br /><br /></span></p>
<p><span style="font-weight: 400;">&ldquo;May I join you, Mrs. Lawrence?&rdquo;</span></p>
<p>&nbsp;</p>
<p><span style="font-weight: 400;">&ldquo;Oh, yes. Come in. I have just finished cleaning.&rdquo;</span></p>
<p>&nbsp;</p>
<p><span style="font-weight: 400;">&ldquo;What a lovely kitchen.&rdquo;</span><span style="font-weight: 400;"><br /></span><span style="font-weight: 400;"><br /></span><span style="font-weight: 400;">&ldquo;It is an absolute luxury, isn&rsquo;t it Detective?&rdquo; Her eyes beamed with pride.</span></p>
<p>&nbsp;</p>
<p><span style="font-weight: 400;">&ldquo;Indeed, it is. All of the finest equipment and so clean, too! I was hoping you had a moment for some questions.&rdquo;</span></p>
<p>&nbsp;</p>
<p><span style="font-weight: 400;">She smiled and said, &ldquo;I do, but I&rsquo;ll need to sit. My knees are not so good these days.&rdquo;</span></p>
<p>&nbsp;</p>
<p><span style="font-weight: 400;">We sat at the staff dining table and shared from a plate of cookies that were still warm from the oven.</span></p>
<p>&nbsp;</p>
<p><span style="font-weight: 400;">&ldquo;Were you responsible for tonight&rsquo;s meal, Mrs. Lawrence?&rdquo;</span></p>
<p>&nbsp;</p>
<p><span style="font-weight: 400;">She looked at her feet before answering, a cookie between her limp fingers, &ldquo;I was.&rdquo;</span></p>
<p>&nbsp;</p>
<p><span style="font-weight: 400;">&ldquo;And what did you serve?&rdquo;</span></p>
<p>&nbsp;</p>
<p><span style="font-weight: 400;">&ldquo;To the guests? Spring salad, pea soup, baked Cod fillets, and some dinner rolls.&rdquo;</span></p>
<p>&nbsp;</p>
<p><span style="font-weight: 400;">&ldquo;The staff ate separately?&rdquo;</span></p>
<p>&nbsp;</p>
<p><span style="font-weight: 400;">&ldquo;Well, we never share food with Mr. Range or his guests, but the staff dinner has been delayed, Detective; we have not eaten. Miss Barton was such a chore this evening that we didn't get our usual chance. A real pitty. I made fresh bread and my famous chilli stew for us.&rdquo;</span></p>
<p>&nbsp;</p>
<p><span style="font-weight: 400;">&ldquo;Were Thomas and Flora around to assist with the dinner service?&rdquo;</span></p>
<p>&nbsp;</p>
<p><span style="font-weight: 400;">&ldquo;Yes, Flora is normally busy cleaning, but she volunteered tonight. They were of great help. Things are always hard to manage when Mr. Range has guests, but Miss Barton has been particularly cumbersome. I was relieved when Thomas said we had only three diners this evening.&rdquo;</span></p>
<p>&nbsp;</p>
<p><span style="font-weight: 400;">&ldquo;Yes, and all three seem to have fallen ill. What did Thomas and Flora do while you were preparing the meals?&rdquo;</span><span style="font-weight: 400;"><br /></span><span style="font-weight: 400;"><br /></span><span style="font-weight: 400;">&ldquo;Thomas was, of course, dashing between the kitchen and dining room, as is his job. And Flora helped me in the kitchen&ndash; though, she had to leave at one point.&rdquo;</span></p>
<p>&nbsp;</p>
<p><span style="font-weight: 400;">&ldquo;Do you know where she went?&rdquo;</span></p>
<p>&nbsp;</p>
<p><span style="font-weight: 400;">&ldquo;No.&rdquo;</span></p>
<p>&nbsp;</p>
<p><span style="font-weight: 400;">&ldquo;Did you leave the kitchen tonight for any reason?&rdquo;</span></p>
<p>&nbsp;</p>
<p><span style="font-weight: 400;">&ldquo;Absolutely not, I was much too busy&hellip;.. well, wait, yes. Actually, detective, a very strange thing happened: the delivery bell at the side door rang just before I was set to plate the soup. I didn&rsquo;t remember ordering anything, but I went to check anyway.&rdquo;</span></p>
<p>&nbsp;</p>
<p><span style="font-weight: 400;">&ldquo;What did you find?&rdquo;</span></p>
<p>&nbsp;</p>
<p><span style="font-weight: 400;">&ldquo;Nothing. I opened the door, and there was no package or delivery person, so I went back to my duties. Thankfully, Flora was keeping an eye on the stove when I returned. Nothing burned while I was gone, and dinner was still served on time, I assure you. &rdquo;</span></p>
<p><br /><br /></p>
<p><span style="font-weight: 400;">&ldquo;Very good. Do you know which guests attended dinner and what they ate?&rdquo;</span><span style="font-weight: 400;"><br /></span><span style="font-weight: 400;"><br /></span><span style="font-weight: 400;">&ldquo;No, I only hear of the complaints. Thomas might know, but the dining room is not my place.&rdquo;</span></p>
<p>&nbsp;</p>
<p><span style="font-weight: 400;">&ldquo;I see. And where do you stay Mrs. Lawrence?&rdquo;</span></p>
<p>&nbsp;</p>
<p><span style="font-weight: 400;">&ldquo;I&rsquo;m in the servant&rsquo;s wing. Flora </span><strong>(3 - P)</strong><span style="font-weight: 400;"> and I </span><strong>(4 - P)</strong><span style="font-weight: 400;"> are neighbors. Thomas&rsquo;s old room is also next to us, but Mr. Range recently moved him into the Winter Suite on the second floor. </span><strong>(7 - P)</strong><span style="font-weight: 400;">.&rdquo;</span></p>


      <!-- </div>
      <div class="bottom-image">
        <img src="assets/IntroNote.jpg" alt="Evidence image">
      </div> -->
    </div>
  </div>

    <script>
    const pages = [
      { type: 'link', filename: 'notes.html', title: 'Notes', counted: false},
      { type: 'link', filename: 'rules.html', title: 'Rules', counted: false},
      { type: 'link', filename: 'intro.html', title: 'Introduction', counted: false},
      { type: 'category', title: 'People' },
      { type: 'link', filename: 'fredwells.html', title: 'Fred Wells' },
      { type: 'link', filename: 'angiewells.html', title: 'Angie Wells' },
      { type: 'link', filename: 'daledawson.html', title: 'Dale Dawson' },
      { type: 'link', filename: 'allenflanders.html', title: 'Allen Flanders' },
      { type: 'link', filename: 'marlabarton.html', title: 'Marla Barton' },
      { type: 'link', filename: 'missflora.html', title: 'Miss Flora - Housekeeper' },
      { type: 'link', filename: 'mrslawrence.html', title: 'Mrs. Lawrence - Cook' },
      { type: 'link', filename: 'thomasgrady.html', title: 'Thomas Grady - Butler' },
      { type: 'category', title: 'First Floor' },
      { type: 'link', filename: 'mainentry.html', title: 'Main Entry' },
      { type: 'link', filename: 'billiardroom.html', title: 'Billiard Room'},
      { type: 'link', filename: 'kitchen.html', title: 'Kitchen', counted: false },
      { type: 'link', filename: 'gardensuite.html', title: 'Garden Suite' },
      { type: 'link', filename: 'thegarden.html', title: 'The Garden' },
      { type: 'link', filename: '12c.html', title: '12 - C' },
      { type: 'link', filename: '9a.html', title: '9 - A' },
      { type: 'link', filename: '3p.html', title: '3 - P', counted: false },
      { type: 'link', filename: '4p.html', title: '4 - P' },
      { type: 'category', title: 'Second Floor' },
      { type: 'link', filename: 'birdroom.html', title: 'Bird Room' },
      { type: 'link', filename: 'warroom.html', title: 'War Room' },
      { type: 'link', filename: 'ivorysuite.html', title: 'Ivory Suite' },
      { type: 'link', filename: '9p.html', title: '9 - P' },
      { type: 'link', filename: '7p.html', title: '7 - P' },
      { type: 'link', filename: '4a.html', title: '4 - A' },
      { type: 'link', filename: '10b.html', title: '10 - B' },
      { type: 'link', filename: '11a.html', title: '11 - A' },
      { type: 'category', title: 'Items' },
      { type: 'link', filename: 'pre1.html', title: 'PrE - 1', counted: false },
      { type: 'link', filename: 'exam.html', title: 'Exam', special: true, counted: false },
      { type: 'link', filename: 'whodunit.html', title: 'Whodunit', special1: true, counted: false },
    ];

    const linkList = document.getElementById("linkList");
    const counter = document.getElementById("counter");
    const menuToggle = document.getElementById("menuToggle");
    const sidebar = document.getElementById("sidebar");
    
    // Debug elements
    const debugVisited = document.getElementById("debugVisited");
    const debugCounted = document.getElementById("debugCounted");
    const debugRemaining = document.getElementById("debugRemaining");

    // Initialize visited pages from localStorage - ensure it's always an array
    let visited = new Set();
    try {
      const stored = localStorage.getItem("visitedPages");
      if (stored) {
        const parsed = JSON.parse(stored);
        if (Array.isArray(parsed)) {
          visited = new Set(parsed);
        }
      }
    } catch (e) {
      console.error("Error loading visited pages:", e);
      localStorage.removeItem("visitedPages"); // Clear corrupted data
    }

    function updateCounter() {
      // Count only pages that should be counted towards the hour limit
      const countedVisitedPages = [...visited].filter(filename => {
        const page = pages.find(p => p.filename === filename);
        return page && page.counted !== false;
      });
      
      const visitedCount = countedVisitedPages.length;
      const remainingHours = Math.max(0, 11 - visitedCount);
      
      // Update counter display
      counter.textContent = remainingHours;
      
      // Update debug info
      // debugVisited.textContent = visited.size;
      // debugCounted.textContent = visitedCount;
      // debugRemaining.textContent = remainingHours;
      
      // Visual warning when getting low
      const counterElement = counter.parentElement;
      if (remainingHours <= 3) {
        counterElement.style.backgroundColor = '#ff0000';
      } else if (remainingHours <= 6) {
        counterElement.style.backgroundColor = '#ff4500';
      } else {
        counterElement.style.backgroundColor = '#8B0000';
      }
      
      console.log(`Counter updated: ${visitedCount} counted visits, ${remainingHours} hours remaining`);
    }

    function saveVisitedPages() {
      try {
        localStorage.setItem("visitedPages", JSON.stringify([...visited]));
      } catch (e) {
        console.error("Error saving visited pages:", e);
      }
    }

    function renderLinks() {
      linkList.innerHTML = ''; // Clear existing links
      
      pages.forEach(item => {
        if (item.type === 'category') {
          const div = document.createElement("div");
          div.className = 'category';
          div.textContent = item.title;
          linkList.appendChild(div);
        } else if (item.type === 'link') {
          const a = document.createElement("a");
          a.href = item.filename;
          a.textContent = item.title;

          // Apply styles based on visited status and special properties
          if (visited.has(item.filename)) {
            a.classList.add("visited");
          }
          if (item.special) {
            a.classList.add("special");
          }
          if (item.special1) {
            a.classList.add("special1");
          }

          // Handle click events
          a.onclick = (e) => {
            console.log(`Clicked: ${item.filename}, was visited: ${visited.has(item.filename)}, counted: ${item.counted !== false}`);
            
            // Only add to visited if not already visited
            if (!visited.has(item.filename)) {
              visited.add(item.filename);
              saveVisitedPages();
              updateCounter();
              console.log(`Added ${item.filename} to visited pages`);
            } else {
              console.log(`${item.filename} already visited`);
            }
            
            // Close sidebar on mobile after clicking
            if (window.innerWidth <= 768) {
              sidebar.classList.remove('open');
            }
            
            // Allow normal navigation to proceed
          };

          linkList.appendChild(a);
        }
      });
    }

    // Initialize everything
    updateCounter();
    renderLinks();

    // Mobile menu toggle
    menuToggle.addEventListener('click', () => {
      sidebar.classList.toggle('open');
    });

    // Close sidebar when clicking outside on mobile
    document.addEventListener('click', (e) => {
      if (window.innerWidth <= 768 && 
          !sidebar.contains(e.target) && 
          !menuToggle.contains(e.target) && 
          sidebar.classList.contains('open')) {
        sidebar.classList.remove('open');
      }
    });

    // Handle resize events
    window.addEventListener('resize', () => {
      if (window.innerWidth > 768) {
        sidebar.classList.remove('open');
      }
    });
  </script>
</body>
</html>